
# Install PHP and Composer
- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.x'

- task: Bash@3
  inputs:
    targetType: 'inline'
    script: |
      # Install PHP and Composer
      sudo apt-get install -y php php-cli php-mbstring php-xml composer

      # Clone the repo (if needed)
      git clone https://github.com/your-username/laragym.git
      cd laragym

      # Install Composer dependencies
      composer install

      # Set the right permissions for storage
      sudo chown -R $USER:www-data storage bootstrap/cache
      sudo chmod -R 775 storage bootstrap/cache

      # Run migrations
      php artisan migrate --force
      php artisan db:seed --force
      
      # Clear cache and optimize
      php artisan config:cache
      php artisan route:cache
